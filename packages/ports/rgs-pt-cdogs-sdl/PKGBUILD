# Maintainer: V0rt3x667 <al-g0l@outlook.com>

pkgname=rgs-pt-cdogs-sdl
pkgver=0.7.3
pkgrel=1
pkgdesc='Enhanced SDL port of DOS arcade game C-Dogs (aka "Cyberdogs 2")'
arch=('x86_64')
url="https://cxong.github.io/cdogs-sdl"
license=('GPL2')
depends=('sdl2' 'sdl2_mixer' 'sdl2_image')
makedepends=('git' 'cmake' 'ninja')
source=(
    "$pkgname::git+https://github.com/cxong/cdogs-sdl.git#tag=$pkgver"
    "https://cxong.github.io/cdogs-sdl/missionpack.zip"
)
md5sums=(
    'SKIP'
    '5570162c603ef601674c13b7d188bd32'
)

build() {
    cd $pkgname

    cmake -GNinja . \
      -DCMAKE_INSTALL_PREFIX=/opt/archrgs/ports/$pkgname \
      -DCDOGS_DATA_DIR=/opt/archrgs/ports/$pkgname/
    ninja
}

package() {
    cd $pkgname

    mkdir -p "$pkgdir/opt/archrgs/ports/$pkgname"
    cp ./src/{cdogs-sdl,cdogs-sdl-editor} "$pkgdir/opt/archrgs/ports/$pkgname"
    cp -r ./{data,doc,dogfights,graphics,missions,music,sounds} "$pkgdir/opt/archrgs/ports/$pkgname"
    cp -r ../missionpack/{dogfights,missions} "$pkgdir/opt/archrgs/ports/$pkgname"
}
